<!--
  Generated template for the Friends page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
	<ion-navbar [color]="'primary'">
		<ion-title>Contacts</ion-title>
	</ion-navbar>
</ion-header>


<ion-content>
	<ion-searchbar *ngIf="!friendsLoading" animated [(ngModel)]="searchTerm" (ngModelChange)="executeSearch()"></ion-searchbar>
	<ion-spinner *ngIf="friendsLoading" text-center margin-vertical class="spinner--full"></ion-spinner>
	<ion-list no-lines no-margin *ngIf="requests.length > 0">
		<ion-item class="friends__request" padding (click)="goToRequests()">
			<ion-badge item-left>{{requests.length}}</ion-badge>
			<h2>New contact requests</h2>
			<ion-note item-right><span>Details&nbsp;</span><ion-icon name="arrow-forward"></ion-icon></ion-note>
		</ion-item>
	</ion-list>
	<ion-list [virtualScroll]="getFriends()" [headerFn]="friendDividers" class="friends__list">
		<ion-item-divider *virtualHeader="let header" class="friends__divider">
			{{ header }}
		</ion-item-divider>

		<ion-item *virtualItem="let friend" (click)="goToUser(friend.id)">
			<h2>
				<strong *ngIf="friend.names.firstname">
					{{friend.names.firstname}}
				</strong>
				<span *ngIf="friend.names.firstname && friend.names.lastname">
					{{friend.names.lastname}}
				</span>
				<strong
					*ngIf="!friend.names.firstname && friend.names.lastname">
					{{friend.names.lastname}}
				</strong>
				<strong
					*ngIf="!friend.names.firstname && !friend.names.lastname">
					{{friend.name}}
				</strong>
			</h2>
		</ion-item>
	</ion-list>
	<ion-item-divider *ngIf="searchResults && searchResults.length > 0" class="friends__divider">
		Worldwide
	</ion-item-divider>
	<ion-spinner *ngIf="searchResultsLoading" text-center margin-vertical class="spinner--full"></ion-spinner>
	<ion-list [virtualScroll]="searchResults" class="friends__list">
		<ion-item *virtualItem="let searchUser" (click)="goToUser(searchUser.id)">
			<h2>
				<strong *ngIf="searchUser.names.firstname">
					{{searchUser.names.firstname}}
				</strong>
				<span *ngIf="searchUser.names.firstname && searchUser.names.lastname">
					{{searchUser.names.lastname}}
				</span>
				<strong
					*ngIf="!searchUser.names.firstname && searchUser.names.lastname">
					{{searchUser.names.lastname}}
				</strong>
				<strong
					*ngIf="!searchUser.names.firstname && !searchUser.names.lastname">
					{{searchUser.name}}
				</strong>
			</h2>
		</ion-item>
	</ion-list>
	<main-menu [icon]="'close'" (mainHandle)="close()" ion-fixed></main-menu>
</ion-content>
